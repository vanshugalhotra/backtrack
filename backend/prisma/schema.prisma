// Tell Prisma what database and what client to generate
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL") // This will be read from your .env file
}

model Problem {
  id          Int        @id @default(autoincrement())
  name        String
  slug        String     @unique
  difficulty  Difficulty
  points      Int
  exePath     String // path to .exe file on disk or in container
  description String // markdown or HTML
  iconPath    String? // optional path to the icon file (could be a URL or file path)
  createdAt   DateTime   @default(now())
  updatedAt   DateTime   @updatedAt

  tests       Test[]     @relation("TestProblems")
}

// Enum for difficulty levels
enum Difficulty {
  EASY
  MEDIUM
  HARD
}

model User {
  id        String   @id @default(uuid())
  email     String   @unique
  password  String
  role      Role     @default(USER)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

enum Role {
  USER
  ADMIN
}

model Test {
  id          Int       @id @default(autoincrement())
  name        String
  slug        String    @unique
  description String?
  password    String // plain-text or minimally hashed
  hasStarted  Boolean   @default(false)
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
  problems    Problem[] @relation("TestProblems")
}
